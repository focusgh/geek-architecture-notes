[toc]

## 27 | 理论一：什么情况下要重构？到底重构什么？又该如何重构？

-   为了让你对重构有个清晰的认识，对于这部分，我安排了六节课的内容，主要包含以下几个方面：
    -   对重构概括性的介绍，包括重构的目的、对象、时机、方法。（今天内容）
    -   保证重构不出错的手段，这里会重点讲解单元测试和代码的可测试性。
    -   不同规模的重构，重点讲大重构和小重构。

### 重构的目的：为什么要重构（why）?

-   定义：

    >   重构是一种对软件内部结构的改善，目的是在不改变软件的可见行为的情况下，使其更易理解，修改成本更低。

-   理解：

    -   在保持功能不变的前提下，利用设计思想、原则、模式、编程规范等理论来优化代码，修改设计上的不足，提高代码质量。

#### 简单了解重构的定义之后，我们重点来看一下，为什么要进行代码重构？

-   首先，重构是时刻保证代码质量的一个极其有效的手段，不至于让代码腐化到无可救药的地步。
-   其次，优秀的代码或架构不是一开始就能完全设计好的，随着系统的演进，重构代码也是不可避免的。
-   最后，重构是避免过度设计的有效手段。

#### 除些之外，重构对一个工程师本身技术成长也有重要的意义。

-   重构实际上就是将一些设计思想、设计原则、设计模式、编程规范理论知识，应用到实践的很好的场景，能够锻炼我们熟练使用这些理论知识的能力。

### 重构的对象：到底重构什么（what）?

-   大重构
-   小重构

### 重构的时机：什么时候重构（when）?

-   我们须要探索一条**可持续、可演进**的方式。
-   所以，我特别提倡的重构策略是**持续重构**。
-   尽管，重构能力很重要，但，**持续重构意识**更重要。

### 重构的方法：又该如何重构（how）?

-   大重构
    -   提前做好完善的重构计划，有条不紊地分阶段来进行。
    -   每个阶段完成一小部分代码的重构，然后提交、测试、运行，发现没问题后，再继续下一个阶段重构，保证代码仓库中的代码一直处于可运行、逻辑正确的状态。
-   对于重构这件事，我提倡，没事就要重构一下代码，时刻保证代码质量处于在一个良好的状态。避免“破窗效应”。

### 重点回顾

