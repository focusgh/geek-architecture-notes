[toc]

## 39 | 运用学过的设计原则和思想完善之前讲的性能计数器项目（上）

-   在版本 2 中，我们会利用之前学过的重构方法，对版本 1 的设计与实现进行重构，解决版本 1 存在的设计问题，让他满足之前学过的设计原则、思想、编程规范。

### 回顾：版本 1 的设计与实现

-   在版本 1 中，整个框架的代码被划分为下面几个类：
    -   MetricsCollector: 
        -   负责打点采集原始数据。
        -   包括记录每次接口请求的响应时间和请求时间戳。
        -   并调用 MetricsStorage 提供的接口来存在这些原始数据。
    -   MetricsStorage 和 RedisMetricsStorage:
        -   负责原始数据的存储与读取。
    -   Aggregator: 
        -   是一个工具类，负责各种统计数据的计算。
        -   比如响应时间的最大值、最小值、平均值、百分位值、接口访问次数、tps。
    -   ConsoleReporter 和 EmailReporter:
        -   相当于一个上帝类（God Class），定时根据给定的时间区间，从数据库中取出数据，借助 Aggregator 类完成统计工作，并将统计结果输出到相应的终端。
        -   比如命令行、邮件。
-   今天，我们重点来看一下 Aggregator 和 ConsoleReporter、EmailReporter 这几个类

### 针对版本 1 的问题进行重构

### Review 版本 2 的设计与实现

### 重点回顾

