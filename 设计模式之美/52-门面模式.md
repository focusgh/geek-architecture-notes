[toc]

## 52 | 门面模式：如何设计合理的接口粒度以兼顾接口的易用性和通用性？

-   应用场景：接口的设计方面使用。
-   解决问题：用来解决接口的可复用性（通用性）和易用性之间的矛盾。

### 门面模式的原理与实现

-   **门面模式**（外观模式）：**门面模式为子系统提供一组统一的接口，定义一组高层接口让子系统更易用。** ---- GoF 《设计模式》

### 门面模式的应用场景举例

-   对于门面模式定义中“子系统”可以有多种理解方式。既可以是一个**完整的系统**，也可以是更细粒度的**类**或者**模块**。

#### 1. 解决易用性问题

-   **用来封装系统的底层实现，隐藏系统的复杂性，提供一组更加简单易用、更高层的接口。**如：Linux 系统调用函数、Linux 的 Shell 命令。

#### 2. 解决性能问题

-   **将多个接口调用替换为一个门面接口调用，减少网络通信成本，提高客户端的响应速度。**

-   如果门面接口不多，我们完全可以将它跟非门面接口放一起。
-   如果门面接口很多，我们可以在已有的接口之上，再重新抽象出一层，专门放置门面接口。
-   如果门面接口特别多，并且很多都是跨多个子系统的，我们可以将门面接口放到一个新的子系统中。

#### 3. 解决分布式事务问题

-   要支持两个接口调用在一个事务中执行，是比较难实现的，这涉及分布式事务问题。
-   我们可以借鉴门面模式的思想，**设计一个包裹两个操作的新接口，让新接口在一个事务中执行两个操作。**

### 重点回顾

-   接口设计的好坏，直接影响到类、模块、系统是否好用。所以，要多花心思在接口的设计上。
-   **完成接口设计，就相当于完成一半的开发任务。只要接口设计得好，那代码就差不到哪里去。**
-   对于接口的可复用性和易用性的一个处理原则是：**尽量保持接口的可复用性，但针对特殊情况，允许提供冗余的门面接口，来提供更易用的接口。**