[toc]

## 01 | 基础架构：一条 SQL 查询语句是如何执行的？

-   MySQL 基本架构示意图
    -   ![img](imgs/0d2070e8f84c4801adbfa03bda1f98d9.png)

### 连接器

-   连接器负责跟客户端建立连接、获取权限、维持和管理连接。

-   连接命令

    -   ```mysql
        
        mysql -h$ip -P$port -u$user -p
        ```

### 查询缓存

-   MySQL 拿到一个查询请求后，会先查询缓存看看，之前是不是执行过这条语句。
-   建议
    -   **多数情况下，我建议你不要使用查询缓存，因为查询缓存往往弊大于利**。

### 分析器

-   “词法分析”，MySQL 需要识别出里面的字符串分别是什么？代表什么？
-   “语法分析”，根据语法规则，判断 SQL 语句是否满足 MySQL 语法。

### 优化器

-   优化器，确定这个语句的执行方案。
-   决定使用哪个索引？或 join 时，决定各个表的连接顺序。

### 执行器

-   先判断对这个表有没有执行权限。
-   根据表的引擎定义，去使用这个引擎提供的接口。

### 小结

-   今天，我给你介绍了 MySQL 的逻辑架构，希望你对一个 SQL 语句完整执行流程的各个阶段有一个初步的印象。