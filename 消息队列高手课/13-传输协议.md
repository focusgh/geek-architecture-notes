[toc]

## 13 | 传输协议：应用程序之间对话的语言

1.  **传输协议就是应用程序之间对话的语言**。

### “断句”问题

1.  使用“**分隔符**”方式

    -   发送数据阶段，加上分隔符。收到数据后，再转义回来。较麻烦，还要损失一些性能。

2.  预置长度

    -   ```
        03 下雨天 03 留客天 02 天留 03 我不留
        ```

    -   实现简单，性能也更好。是目前普遍采用的一种分隔数据的方法。

### 用双工收发协议提升吞吐量

1.  **单工通信**
    -   请求和响应是按照顺序依次收发，效率较低。如 HTTP1
    -   ![img](imgs/bcbcec4ce8e9120b28b5627e56cb0ccd.jpg)
2.  双工通信
    -   同时进行数据的双向收发，互不受任何影响，能提高吞吐量。
    -   ![img](imgs/8a6587851a0fbc9fd0e4c9d09357aee5.jpg)
3.  问题：问题和答案可能已经对不上。顺序也没法保证。
    -   ![img](imgs/29d696771575b46258e4d6bd809c8c46.jpg)
4.  解决：**发送请求时，给每个请求加一个序号，这个序号在本次会话内保证唯一，然后在响应中带上请求的序号**。
    -   <img src="imgs/7c944db7d136f3b9c027be3e99685f18.jpg" alt="img" style="zoom:24%;" />

### 小结

1.  如何解决断句问题：
    -   分隔符
    -   前置长度
2.  一种比较通用的实现双工通信的方法，“**使用 ID 来标识请求与响应对应关系**”